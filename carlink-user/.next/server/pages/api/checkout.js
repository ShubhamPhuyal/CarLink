"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/checkout";
exports.ids = ["pages/api/checkout"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "stripe":
/*!*************************!*\
  !*** external "stripe" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stripe");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheckout&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheckout.js&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheckout&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheckout.js&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_checkout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\checkout.js */ \"(api)/./pages/api/checkout.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_checkout_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_checkout_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/checkout\",\n        pathname: \"/api/checkout\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_checkout_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNoZWNrb3V0JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNjaGVja291dC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNzRDtBQUN0RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsbURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLG1EQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2NhcmxpbmstdXNlci8/MTNkMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGNoZWNrb3V0LmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hlY2tvdXRcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGVja291dFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheckout&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheckout.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/mongoose.js":
/*!*************************!*\
  !*** ./lib/mongoose.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   mongooseConnect: () => (/* binding */ mongooseConnect)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction mongooseConnect() {\n    if ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().connection).readyState === 1) {\n        return mongoose__WEBPACK_IMPORTED_MODULE_0___default().connection.asPromise();\n    } else {\n        const uri = process.env.MONGODB_URI;\n        return mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(uri);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbW9uZ29vc2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWdDO0FBRXpCLFNBQVNDO0lBQ1osSUFBSUQsNERBQW1CLENBQUNHLFVBQVUsS0FBSyxHQUFHO1FBQ3RDLE9BQU9ILDBEQUFtQixDQUFDSSxTQUFTO0lBQ3hDLE9BQU87UUFDSCxNQUFNQyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLFdBQVc7UUFDbkMsT0FBT1IsdURBQWdCLENBQUNLO0lBQzVCO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYXJsaW5rLXVzZXIvLi9saWIvbW9uZ29vc2UuanM/MTYzZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbW9uZ29vc2VDb25uZWN0KCkge1xyXG4gICAgaWYgKG1vbmdvb3NlLmNvbm5lY3Rpb24ucmVhZHlTdGF0ZSA9PT0gMSkge1xyXG4gICAgICAgIHJldHVybiBtb25nb29zZS5jb25uZWN0aW9uLmFzUHJvbWlzZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCB1cmkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcclxuICAgICAgICByZXR1cm4gbW9uZ29vc2UuY29ubmVjdCh1cmkpO1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJtb25nb29zZSIsIm1vbmdvb3NlQ29ubmVjdCIsImNvbm5lY3Rpb24iLCJyZWFkeVN0YXRlIiwiYXNQcm9taXNlIiwidXJpIiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJJIiwiY29ubmVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/mongoose.js\n");

/***/ }),

/***/ "(api)/./models/Order.js":
/*!*************************!*\
  !*** ./models/Order.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Order: () => (/* binding */ Order)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n// models/Order.js\n\nconst OrderSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    line_items: Object,\n    name: String,\n    email: String,\n    city: String,\n    postalCode: String,\n    streetAddress: String,\n    country: String,\n    paid: Boolean,\n    status: {\n        type: String,\n        required: true,\n        enum: [\n            \"pending\",\n            \"processing\",\n            \"shipped\",\n            \"delivered\",\n            \"cancelled\",\n            \"refunded\"\n        ],\n        default: \"pending\"\n    }\n}, {\n    timestamps: true\n});\nconst Order = mongoose__WEBPACK_IMPORTED_MODULE_0__.models?.Order || (0,mongoose__WEBPACK_IMPORTED_MODULE_0__.model)(\"Order\", OrderSchema);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvT3JkZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsa0JBQWtCO0FBQytCO0FBRWpELE1BQU1HLGNBQWMsSUFBSUQsNENBQU1BLENBQUM7SUFDN0JFLFlBQVlDO0lBQ1pDLE1BQU1DO0lBQ05DLE9BQU9EO0lBQ1BFLE1BQU1GO0lBQ05HLFlBQVlIO0lBQ1pJLGVBQWVKO0lBQ2ZLLFNBQVNMO0lBQ1RNLE1BQU1DO0lBQ05DLFFBQVE7UUFDTkMsTUFBTVQ7UUFDTlUsVUFBVTtRQUNWQyxNQUFNO1lBQUM7WUFBVztZQUFjO1lBQVc7WUFBYTtZQUFhO1NBQVc7UUFDaEZDLFNBQVM7SUFDWDtBQUNGLEdBQUc7SUFDREMsWUFBWTtBQUNkO0FBRU8sTUFBTUMsUUFBUXBCLDRDQUFNQSxFQUFFb0IsU0FBU3JCLCtDQUFLQSxDQUFDLFNBQVNHLGFBQWEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYXJsaW5rLXVzZXIvLi9tb2RlbHMvT3JkZXIuanM/ZWIyOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBtb2RlbHMvT3JkZXIuanNcclxuaW1wb3J0IHsgbW9kZWwsIG1vZGVscywgU2NoZW1hIH0gZnJvbSBcIm1vbmdvb3NlXCI7XHJcblxyXG5jb25zdCBPcmRlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xyXG4gIGxpbmVfaXRlbXM6IE9iamVjdCxcclxuICBuYW1lOiBTdHJpbmcsXHJcbiAgZW1haWw6IFN0cmluZyxcclxuICBjaXR5OiBTdHJpbmcsXHJcbiAgcG9zdGFsQ29kZTogU3RyaW5nLFxyXG4gIHN0cmVldEFkZHJlc3M6IFN0cmluZyxcclxuICBjb3VudHJ5OiBTdHJpbmcsXHJcbiAgcGFpZDogQm9vbGVhbixcclxuICBzdGF0dXM6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgZW51bTogWydwZW5kaW5nJywgJ3Byb2Nlc3NpbmcnLCAnc2hpcHBlZCcsICdkZWxpdmVyZWQnLCAnY2FuY2VsbGVkJywgJ3JlZnVuZGVkJ10sXHJcbiAgICBkZWZhdWx0OiAncGVuZGluZydcclxuICB9LFxyXG59LCB7XHJcbiAgdGltZXN0YW1wczogdHJ1ZSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgT3JkZXIgPSBtb2RlbHM/Lk9yZGVyIHx8IG1vZGVsKCdPcmRlcicsIE9yZGVyU2NoZW1hKTsiXSwibmFtZXMiOlsibW9kZWwiLCJtb2RlbHMiLCJTY2hlbWEiLCJPcmRlclNjaGVtYSIsImxpbmVfaXRlbXMiLCJPYmplY3QiLCJuYW1lIiwiU3RyaW5nIiwiZW1haWwiLCJjaXR5IiwicG9zdGFsQ29kZSIsInN0cmVldEFkZHJlc3MiLCJjb3VudHJ5IiwicGFpZCIsIkJvb2xlYW4iLCJzdGF0dXMiLCJ0eXBlIiwicmVxdWlyZWQiLCJlbnVtIiwiZGVmYXVsdCIsInRpbWVzdGFtcHMiLCJPcmRlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./models/Order.js\n");

/***/ }),

/***/ "(api)/./models/Product.js":
/*!***************************!*\
  !*** ./models/Product.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Product: () => (/* binding */ Product)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\n// Ensure models is defined\nconst models = (mongoose__WEBPACK_IMPORTED_MODULE_0___default().models) || {};\nconst ProductSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    title: {\n        type: String,\n        required: true\n    },\n    description: String,\n    price: {\n        type: Number,\n        required: true\n    },\n    images: [\n        {\n            type: String\n        }\n    ],\n    category: {\n        type: mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema.Types.ObjectId,\n        ref: \"Category\"\n    },\n    properties: {\n        type: Object\n    },\n    owner: {\n        type: (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema).Types.ObjectId,\n        ref: \"User\",\n        required: true\n    }\n}, {\n    timestamps: true\n});\nconst Product = models.Product || (0,mongoose__WEBPACK_IMPORTED_MODULE_0__.model)(\"Product\", ProductSchema);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvUHJvZHVjdC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBbUQ7QUFFbkQsMkJBQTJCO0FBQzNCLE1BQU1HLFNBQVNILHdEQUFlLElBQUksQ0FBQztBQUVuQyxNQUFNSSxnQkFBZ0IsSUFBSUYsNENBQU1BLENBQUM7SUFDL0JHLE9BQU87UUFBRUMsTUFBTUM7UUFBUUMsVUFBVTtJQUFLO0lBQ3RDQyxhQUFhRjtJQUNiRyxPQUFPO1FBQUVKLE1BQU1LO1FBQVFILFVBQVU7SUFBSztJQUN0Q0ksUUFBUTtRQUFDO1lBQUVOLE1BQU1DO1FBQU87S0FBRTtJQUMxQk0sVUFBVTtRQUFFUCxNQUFNSiw0Q0FBTUEsQ0FBQ1ksS0FBSyxDQUFDQyxRQUFRO1FBQUVDLEtBQUs7SUFBVTtJQUN4REMsWUFBWTtRQUFFWCxNQUFNWTtJQUFPO0lBQzNCQyxPQUFPO1FBQUViLE1BQU1OLHdEQUFlLENBQUNjLEtBQUssQ0FBQ0MsUUFBUTtRQUFFQyxLQUFLO1FBQVFSLFVBQVU7SUFBSztBQUM3RSxHQUFHO0lBQ0NZLFlBQVk7QUFDaEI7QUFFTyxNQUFNQyxVQUFVbEIsT0FBT2tCLE9BQU8sSUFBSXBCLCtDQUFLQSxDQUFDLFdBQVdHLGVBQWUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYXJsaW5rLXVzZXIvLi9tb2RlbHMvUHJvZHVjdC5qcz8wOWM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSwgeyBtb2RlbCwgU2NoZW1hIH0gZnJvbSBcIm1vbmdvb3NlXCI7XHJcblxyXG4vLyBFbnN1cmUgbW9kZWxzIGlzIGRlZmluZWRcclxuY29uc3QgbW9kZWxzID0gbW9uZ29vc2UubW9kZWxzIHx8IHt9O1xyXG5cclxuY29uc3QgUHJvZHVjdFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xyXG4gIHRpdGxlOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICBkZXNjcmlwdGlvbjogU3RyaW5nLFxyXG4gIHByaWNlOiB7IHR5cGU6IE51bWJlciwgcmVxdWlyZWQ6IHRydWUgfSxcclxuICBpbWFnZXM6IFt7IHR5cGU6IFN0cmluZyB9XSxcclxuICBjYXRlZ29yeTogeyB0eXBlOiBTY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ0NhdGVnb3J5J30sXHJcbiAgcHJvcGVydGllczogeyB0eXBlOiBPYmplY3QgfSxcclxuICBvd25lcjogeyB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ1VzZXInLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG59LCB7XHJcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBQcm9kdWN0ID0gbW9kZWxzLlByb2R1Y3QgfHwgbW9kZWwoJ1Byb2R1Y3QnLCBQcm9kdWN0U2NoZW1hKTtcclxuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwibW9kZWwiLCJTY2hlbWEiLCJtb2RlbHMiLCJQcm9kdWN0U2NoZW1hIiwidGl0bGUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJkZXNjcmlwdGlvbiIsInByaWNlIiwiTnVtYmVyIiwiaW1hZ2VzIiwiY2F0ZWdvcnkiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwicHJvcGVydGllcyIsIk9iamVjdCIsIm93bmVyIiwidGltZXN0YW1wcyIsIlByb2R1Y3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./models/Product.js\n");

/***/ }),

/***/ "(api)/./pages/api/checkout.js":
/*!*******************************!*\
  !*** ./pages/api/checkout.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/mongoose */ \"(api)/./lib/mongoose.js\");\n/* harmony import */ var _models_Product__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/models/Product */ \"(api)/./models/Product.js\");\n/* harmony import */ var _models_Order__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/models/Order */ \"(api)/./models/Order.js\");\n\n\n\nconst stripe = __webpack_require__(/*! stripe */ \"stripe\")(process.env.STRIPE_SK);\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method Not Allowed. Use POST.\"\n        });\n    }\n    const { name, email, city, postalCode, streetAddress, country, cartProducts } = req.body;\n    if (!cartProducts || cartProducts.length === 0) {\n        return res.status(400).json({\n            error: \"Cart is empty.\"\n        });\n    }\n    await (0,_lib_mongoose__WEBPACK_IMPORTED_MODULE_0__.mongooseConnect)();\n    const uniqueIds = [\n        ...new Set(cartProducts)\n    ];\n    const productsInfos = await _models_Product__WEBPACK_IMPORTED_MODULE_1__.Product.find({\n        _id: uniqueIds\n    });\n    let line_items = [];\n    for (const productId of uniqueIds){\n        const productInfo = productsInfos.find((p)=>p._id.toString() === productId);\n        const quantity = cartProducts.filter((id)=>id === productId)?.length || 0;\n        if (quantity > 0 && productInfo) {\n            line_items.push({\n                quantity,\n                price_data: {\n                    currency: \"USD\",\n                    product_data: {\n                        name: productInfo.title\n                    },\n                    unit_amount: productInfo.price * 100\n                }\n            });\n        }\n    }\n    if (line_items.length === 0) {\n        return res.status(400).json({\n            error: \"No valid products found.\"\n        });\n    }\n    try {\n        const orderDoc = await _models_Order__WEBPACK_IMPORTED_MODULE_2__.Order.create({\n            line_items,\n            name,\n            email,\n            city,\n            postalCode,\n            streetAddress,\n            country,\n            paid: false\n        });\n        const session = await stripe.checkout.sessions.create({\n            line_items,\n            mode: \"payment\",\n            customer_email: email,\n            success_url: `${process.env.NEXTAUTH_URL || \"http://localhost:3001\"}/cart?success=1`,\n            cancel_url: `${process.env.NEXTAUTH_URL || \"http://localhost:3001\"}/cart?canceled=1`,\n            metadata: {\n                orderId: orderDoc._id.toString()\n            }\n        });\n        res.json({\n            url: session.url\n        });\n    } catch (error) {\n        console.error(\"Stripe Checkout Error:\", error);\n        res.status(500).json({\n            error: \"Error creating checkout session\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvY2hlY2tvdXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFpRDtBQUNOO0FBQ0o7QUFDdkMsTUFBTUcsU0FBU0MsbUJBQU9BLENBQUMsc0JBQVEsRUFBRUMsUUFBUUMsR0FBRyxDQUFDQyxTQUFTO0FBRXZDLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBZ0M7SUFDdkU7SUFFQSxNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxJQUFJLEVBQUVDLFVBQVUsRUFBRUMsYUFBYSxFQUFFQyxPQUFPLEVBQUVDLFlBQVksRUFBRSxHQUFHWixJQUFJYSxJQUFJO0lBRXhGLElBQUksQ0FBQ0QsZ0JBQWdCQSxhQUFhRSxNQUFNLEtBQUssR0FBRztRQUM5QyxPQUFPYixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBaUI7SUFDeEQ7SUFFQSxNQUFNZCw4REFBZUE7SUFFckIsTUFBTXdCLFlBQVk7V0FBSSxJQUFJQyxJQUFJSjtLQUFjO0lBQzVDLE1BQU1LLGdCQUFnQixNQUFNekIsb0RBQU9BLENBQUMwQixJQUFJLENBQUM7UUFBRUMsS0FBS0o7SUFBVTtJQUUxRCxJQUFJSyxhQUFhLEVBQUU7SUFDbkIsS0FBSyxNQUFNQyxhQUFhTixVQUFXO1FBQ2pDLE1BQU1PLGNBQWNMLGNBQWNDLElBQUksQ0FBQ0ssQ0FBQUEsSUFBS0EsRUFBRUosR0FBRyxDQUFDSyxRQUFRLE9BQU9IO1FBQ2pFLE1BQU1JLFdBQVdiLGFBQWFjLE1BQU0sQ0FBQ0MsQ0FBQUEsS0FBTUEsT0FBT04sWUFBWVAsVUFBVTtRQUV4RSxJQUFJVyxXQUFXLEtBQUtILGFBQWE7WUFDL0JGLFdBQVdRLElBQUksQ0FBQztnQkFDZEg7Z0JBQ0FJLFlBQVk7b0JBQ1ZDLFVBQVU7b0JBQ1ZDLGNBQWM7d0JBQUV6QixNQUFNZ0IsWUFBWVUsS0FBSztvQkFBQztvQkFDeENDLGFBQWFYLFlBQVlZLEtBQUssR0FBRztnQkFDbkM7WUFDRjtRQUNGO0lBQ0Y7SUFFQSxJQUFJZCxXQUFXTixNQUFNLEtBQUssR0FBRztRQUMzQixPQUFPYixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBMkI7SUFDbEU7SUFFQSxJQUFJO1FBQ0YsTUFBTThCLFdBQVcsTUFBTTFDLGdEQUFLQSxDQUFDMkMsTUFBTSxDQUFDO1lBQ2xDaEI7WUFDQWQ7WUFDQUM7WUFDQUM7WUFDQUM7WUFDQUM7WUFDQUM7WUFDQTBCLE1BQU07UUFDUjtRQUVBLE1BQU1DLFVBQVUsTUFBTTVDLE9BQU82QyxRQUFRLENBQUNDLFFBQVEsQ0FBQ0osTUFBTSxDQUFDO1lBQ3BEaEI7WUFDQXFCLE1BQU07WUFDTkMsZ0JBQWdCbkM7WUFDaEJvQyxhQUFhLENBQUMsRUFBRS9DLFFBQVFDLEdBQUcsQ0FBQytDLFlBQVksSUFBSSx3QkFBd0IsZUFBZSxDQUFDO1lBQ3BGQyxZQUFZLENBQUMsRUFBRWpELFFBQVFDLEdBQUcsQ0FBQytDLFlBQVksSUFBSSx3QkFBd0IsZ0JBQWdCLENBQUM7WUFDcEZFLFVBQVU7Z0JBQUVDLFNBQVNaLFNBQVNoQixHQUFHLENBQUNLLFFBQVE7WUFBRztRQUMvQztRQUVBdkIsSUFBSUcsSUFBSSxDQUFDO1lBQUU0QyxLQUFLVixRQUFRVSxHQUFHO1FBQUM7SUFDOUIsRUFBRSxPQUFPM0MsT0FBTztRQUNkNEMsUUFBUTVDLEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBa0M7SUFDbEU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2NhcmxpbmstdXNlci8uL3BhZ2VzL2FwaS9jaGVja291dC5qcz9kMWEzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1vbmdvb3NlQ29ubmVjdCB9IGZyb20gXCJAL2xpYi9tb25nb29zZVwiO1xyXG5pbXBvcnQgeyBQcm9kdWN0IH0gZnJvbSBcIkAvbW9kZWxzL1Byb2R1Y3RcIjtcclxuaW1wb3J0IHsgT3JkZXIgfSBmcm9tIFwiQC9tb2RlbHMvT3JkZXJcIjtcclxuY29uc3Qgc3RyaXBlID0gcmVxdWlyZShcInN0cmlwZVwiKShwcm9jZXNzLmVudi5TVFJJUEVfU0spO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6IFwiTWV0aG9kIE5vdCBBbGxvd2VkLiBVc2UgUE9TVC5cIiB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHsgbmFtZSwgZW1haWwsIGNpdHksIHBvc3RhbENvZGUsIHN0cmVldEFkZHJlc3MsIGNvdW50cnksIGNhcnRQcm9kdWN0cyB9ID0gcmVxLmJvZHk7XHJcblxyXG4gIGlmICghY2FydFByb2R1Y3RzIHx8IGNhcnRQcm9kdWN0cy5sZW5ndGggPT09IDApIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIkNhcnQgaXMgZW1wdHkuXCIgfSk7XHJcbiAgfVxyXG5cclxuICBhd2FpdCBtb25nb29zZUNvbm5lY3QoKTtcclxuXHJcbiAgY29uc3QgdW5pcXVlSWRzID0gWy4uLm5ldyBTZXQoY2FydFByb2R1Y3RzKV07XHJcbiAgY29uc3QgcHJvZHVjdHNJbmZvcyA9IGF3YWl0IFByb2R1Y3QuZmluZCh7IF9pZDogdW5pcXVlSWRzIH0pO1xyXG5cclxuICBsZXQgbGluZV9pdGVtcyA9IFtdO1xyXG4gIGZvciAoY29uc3QgcHJvZHVjdElkIG9mIHVuaXF1ZUlkcykge1xyXG4gICAgY29uc3QgcHJvZHVjdEluZm8gPSBwcm9kdWN0c0luZm9zLmZpbmQocCA9PiBwLl9pZC50b1N0cmluZygpID09PSBwcm9kdWN0SWQpO1xyXG4gICAgY29uc3QgcXVhbnRpdHkgPSBjYXJ0UHJvZHVjdHMuZmlsdGVyKGlkID0+IGlkID09PSBwcm9kdWN0SWQpPy5sZW5ndGggfHwgMDtcclxuXHJcbiAgICBpZiAocXVhbnRpdHkgPiAwICYmIHByb2R1Y3RJbmZvKSB7XHJcbiAgICAgIGxpbmVfaXRlbXMucHVzaCh7XHJcbiAgICAgICAgcXVhbnRpdHksXHJcbiAgICAgICAgcHJpY2VfZGF0YToge1xyXG4gICAgICAgICAgY3VycmVuY3k6IFwiVVNEXCIsXHJcbiAgICAgICAgICBwcm9kdWN0X2RhdGE6IHsgbmFtZTogcHJvZHVjdEluZm8udGl0bGUgfSxcclxuICAgICAgICAgIHVuaXRfYW1vdW50OiBwcm9kdWN0SW5mby5wcmljZSAqIDEwMCwgLy8g4pyFIEZpeGVkOiBFbnN1cmUgcHJpY2UgaXMgaW4gY2VudHNcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlmIChsaW5lX2l0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IFwiTm8gdmFsaWQgcHJvZHVjdHMgZm91bmQuXCIgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3Qgb3JkZXJEb2MgPSBhd2FpdCBPcmRlci5jcmVhdGUoe1xyXG4gICAgICBsaW5lX2l0ZW1zLFxyXG4gICAgICBuYW1lLFxyXG4gICAgICBlbWFpbCxcclxuICAgICAgY2l0eSxcclxuICAgICAgcG9zdGFsQ29kZSxcclxuICAgICAgc3RyZWV0QWRkcmVzcyxcclxuICAgICAgY291bnRyeSxcclxuICAgICAgcGFpZDogZmFsc2UsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgc3RyaXBlLmNoZWNrb3V0LnNlc3Npb25zLmNyZWF0ZSh7XHJcbiAgICAgIGxpbmVfaXRlbXMsXHJcbiAgICAgIG1vZGU6IFwicGF5bWVudFwiLFxyXG4gICAgICBjdXN0b21lcl9lbWFpbDogZW1haWwsXHJcbiAgICAgIHN1Y2Nlc3NfdXJsOiBgJHtwcm9jZXNzLmVudi5ORVhUQVVUSF9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMSd9L2NhcnQ/c3VjY2Vzcz0xYCxcclxuICAgICAgY2FuY2VsX3VybDogYCR7cHJvY2Vzcy5lbnYuTkVYVEFVVEhfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDEnfS9jYXJ0P2NhbmNlbGVkPTFgLFxyXG4gICAgICBtZXRhZGF0YTogeyBvcmRlcklkOiBvcmRlckRvYy5faWQudG9TdHJpbmcoKSB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLmpzb24oeyB1cmw6IHNlc3Npb24udXJsIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiU3RyaXBlIENoZWNrb3V0IEVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBcIkVycm9yIGNyZWF0aW5nIGNoZWNrb3V0IHNlc3Npb25cIiB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIm1vbmdvb3NlQ29ubmVjdCIsIlByb2R1Y3QiLCJPcmRlciIsInN0cmlwZSIsInJlcXVpcmUiLCJwcm9jZXNzIiwiZW52IiwiU1RSSVBFX1NLIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsIm5hbWUiLCJlbWFpbCIsImNpdHkiLCJwb3N0YWxDb2RlIiwic3RyZWV0QWRkcmVzcyIsImNvdW50cnkiLCJjYXJ0UHJvZHVjdHMiLCJib2R5IiwibGVuZ3RoIiwidW5pcXVlSWRzIiwiU2V0IiwicHJvZHVjdHNJbmZvcyIsImZpbmQiLCJfaWQiLCJsaW5lX2l0ZW1zIiwicHJvZHVjdElkIiwicHJvZHVjdEluZm8iLCJwIiwidG9TdHJpbmciLCJxdWFudGl0eSIsImZpbHRlciIsImlkIiwicHVzaCIsInByaWNlX2RhdGEiLCJjdXJyZW5jeSIsInByb2R1Y3RfZGF0YSIsInRpdGxlIiwidW5pdF9hbW91bnQiLCJwcmljZSIsIm9yZGVyRG9jIiwiY3JlYXRlIiwicGFpZCIsInNlc3Npb24iLCJjaGVja291dCIsInNlc3Npb25zIiwibW9kZSIsImN1c3RvbWVyX2VtYWlsIiwic3VjY2Vzc191cmwiLCJORVhUQVVUSF9VUkwiLCJjYW5jZWxfdXJsIiwibWV0YWRhdGEiLCJvcmRlcklkIiwidXJsIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/checkout.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheckout&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheckout.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();